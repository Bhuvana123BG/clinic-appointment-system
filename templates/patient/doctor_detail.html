{% extends "base.html" %}
{% block content %}
{% include "includes/nav_pat.html" %}
{% include "includes/messages.html" %}

<div class="container my-5">

  
    <!-- Doctor Info -->
    <div class="card shadow-sm border-0 mb-4">
      <div class="card-body text-center">
        <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center mx-auto mb-3"
             style="width:80px; height:80px; font-size:24px;">
          {{ doctor.user.username|default:doctor.user.email|slice:":1"|upper }}
        </div>
        <h4 class="fw-bold">Dr. {{ doctor.user.username|title }}</h4>
        <p class="text-muted mb-1">Specialization: {{ doctor.specialization }}</p>
        {% if doctor.availability %}
          <p><span class="badge bg-success">Available</span> {{ doctor.availability }}</p>
        {% else %}
          <p><span class="badge bg-secondary">Schedule Not Set</span></p>
        {% endif %}
  
        <!-- Action Buttons -->
        <button class="btn btn-primary mt-2" data-bs-toggle="modal" data-bs-target="#requestModal">
          Request Appointment
        </button>
      </div>
    </div>
  
    <!-- Approved Appointments History -->
    <div class="card shadow-sm border-0">
      <div class="card-body">
        <h5 class="fw-bold text-primary mb-3">âœ… Approved Appointments</h5>
        
        {% if approved_appointments %}
          <div class="table-responsive">
            <table class="table table-hover align-middle">
              <thead class="table-light">
                <tr>
                  <th>Patient</th>
                  <th>Date</th>
                  <th>Reason</th>
                </tr>
              </thead>
              <tbody>
                {% for a in approved_appointments %}
                  <tr>
                    <td>{{ a.patient.user.username|title }}</td>
                    <td>{{ a.date }}</td>
                    <td>{{ a.reason }}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <p class="text-muted">No approved appointments yet.</p>
        {% endif %}
      </div>
    </div>
  </div>
  
  <!-- Include the Modal Here -->
  {% comment %} {% include "includes/request_modal.html" %} {% endcomment %}
  
<!-- Appointment Request Modal -->
{% include "includes/request_modal.html" %}
{% endblock %}
